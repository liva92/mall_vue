{"remainingRequest":"C:\\Users\\67564\\Desktop\\面试\\mall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\67564\\Desktop\\面试\\mall\\src\\views\\home\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\67564\\Desktop\\面试\\mall\\src\\views\\home\\Home.vue","mtime":1577183492491},{"path":"C:\\Users\\67564\\Desktop\\面试\\mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576308382003},{"path":"C:\\Users\\67564\\Desktop\\面试\\mall\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\67564\\Desktop\\面试\\mall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1576308382003},{"path":"C:\\Users\\67564\\Desktop\\面试\\mall\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport NavBar from \"common/navbar/NavBar\";\r\nimport Scroll from \"common/scroll/Scroll\";\r\nimport TabControl from \"content/tabControl/TabControl\";\r\nimport BackTop from \"content/backTop/BackTop\";\r\nimport HomeSwiper from \"./childComps/HomeSwiper\";\r\nimport FeatureView from \"./childComps/FeatureView\";\r\nimport RecommendView from \"./childComps/RecommendView\";\r\nimport GoodsList from \"./childComps/GoodsList\";\r\nimport { getHomeMultidata, getHomeData, RECOMMEND, BANNER } from \"network/home\";\r\nimport { NEW, POP, SELL, BACKTOP_DISTANCE } from \"@/common/const\";\r\n\r\nexport default {\r\n  name: \"Home\",\r\n  components: {\r\n    NavBar,\r\n    Scroll,\r\n    TabControl,\r\n    BackTop,\r\n    HomeSwiper,\r\n    FeatureView,\r\n    RecommendView,\r\n    GoodsList\r\n  },\r\n  data() {\r\n    return {\r\n      banners: [],\r\n      recommends: [],\r\n      goodsList: {\r\n        pop: { page: 1, list: [] },\r\n        new: { page: 1, list: [] },\r\n        sell: { page: 1, list: [] }\r\n      },\r\n      currentType: POP,\r\n      isTabFixed: false,\r\n      tabOffsetTop: 0,\r\n      showBackTop: false\r\n    };\r\n  },\r\n  computed: {\r\n    showGoodsList() {\r\n      return this.goodsList[this.currentType].list;\r\n    }\r\n  },\r\n  created() {\r\n    // console.log('创建Home');\r\n    // 1.请求多个数据\r\n    this.getMultiData();\r\n\r\n    // 2.请求商品数据\r\n    this.getHomeProducts(POP);\r\n    this.getHomeProducts(NEW);\r\n    this.getHomeProducts(SELL);\r\n  },\r\n  activated: function() {\r\n    this.$refs.hSwiper.startTimer();\r\n  },\r\n  deactivated: function() {\r\n    this.$refs.hSwiper.stopTimer();\r\n  },\r\n  updated() {\r\n    // this.tabOffsetTop = this.$refs.tabControl.$el.offsetTop\r\n    // console.log(this.tabOffsetTop);\r\n  },\r\n  methods: {\r\n    tabClick(index) {\r\n      switch (index) {\r\n        case 0:\r\n          this.currentType = POP;\r\n          break;\r\n        case 1:\r\n          this.currentType = NEW;\r\n          break;\r\n        case 2:\r\n          this.currentType = SELL;\r\n          break;\r\n      }\r\n    },\r\n    contentScroll(position) {\r\n      // 1.决定tabFixed是否显示\r\n      this.isTabFixed = -position.y > this.tabOffsetTop;\r\n\r\n      // 2.决定backTop是否显示\r\n      this.showBackTop = -position.y > BACKTOP_DISTANCE;\r\n    },\r\n    loadMore() {\r\n      this.getHomeProducts(this.currentType);\r\n    },\r\n    backTop() {\r\n      this.$refs.scroll.scrollTo(0, 0, 300);\r\n      console.log(\"回到顶部\");\r\n    },\r\n    /**\r\n     * 网络请求相关方法\r\n     */\r\n    getMultiData() {\r\n      getHomeMultidata().then(res => {\r\n        this.banners = res.data[BANNER].list;\r\n        this.recommends = res.data[RECOMMEND].list;\r\n        // 下次更新DOM时,获取新的tabOffsetTop值(不保险,可以在updated钩子中获取)\r\n        this.$nextTick(() => {\r\n          this.tabOffsetTop = this.$refs.tabControl.$el.offsetTop;\r\n        });\r\n      });\r\n    },\r\n    getHomeProducts(type) {\r\n      getHomeData(type, this.goodsList[type].page).then(res => {\r\n        // console.log(res)\r\n        const goodsList = res.data.list;\r\n        this.goodsList[type].list.push(...goodsList);\r\n        this.goodsList[type].page += 1;\r\n\r\n        this.$refs.scroll.finishPullUp();\r\n      });\r\n    }\r\n  }\r\n};\r\n",{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src\\views\\home","sourcesContent":["<template>\r\n  <div id=\"home\">\r\n    <nav-bar class=\"nav-bar\">\r\n      <div slot=\"center\">购物街</div>\r\n    </nav-bar>\r\n    <tab-control\r\n      v-show=\"isTabFixed\"\r\n      class=\"fixed\"\r\n      @itemClick=\"tabClick\"\r\n      :titles=\"['流行', '新款', '精选']\"\r\n    ></tab-control>\r\n    <scroll\r\n      class=\"content\"\r\n      ref=\"scroll\"\r\n      @scroll=\"contentScroll\"\r\n      @pullingUp=\"loadMore\"\r\n      :data=\"showGoodsList\"\r\n      :pull-up-load=\"true\"\r\n      :probe-type=\"3\"\r\n    >\r\n      <div>\r\n        <home-swiper :banners=\"banners\" ref=\"hSwiper\"></home-swiper>\r\n        <feature-view :features=\"recommends\"></feature-view>\r\n        <recommend-view></recommend-view>\r\n        <tab-control @itemClick=\"tabClick\" :titles=\"['流行', '新款', '精选']\" ref=\"tabControl\"></tab-control>\r\n        <goods-list :goods-list=\"showGoodsList\"></goods-list>\r\n      </div>\r\n    </scroll>\r\n    <back-top @backTop=\"backTop\" class=\"back-top\" v-show=\"showBackTop\">\r\n      <img src=\"~assets/img/common/top.png\" alt />\r\n    </back-top>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from \"common/navbar/NavBar\";\r\nimport Scroll from \"common/scroll/Scroll\";\r\nimport TabControl from \"content/tabControl/TabControl\";\r\nimport BackTop from \"content/backTop/BackTop\";\r\nimport HomeSwiper from \"./childComps/HomeSwiper\";\r\nimport FeatureView from \"./childComps/FeatureView\";\r\nimport RecommendView from \"./childComps/RecommendView\";\r\nimport GoodsList from \"./childComps/GoodsList\";\r\nimport { getHomeMultidata, getHomeData, RECOMMEND, BANNER } from \"network/home\";\r\nimport { NEW, POP, SELL, BACKTOP_DISTANCE } from \"@/common/const\";\r\n\r\nexport default {\r\n  name: \"Home\",\r\n  components: {\r\n    NavBar,\r\n    Scroll,\r\n    TabControl,\r\n    BackTop,\r\n    HomeSwiper,\r\n    FeatureView,\r\n    RecommendView,\r\n    GoodsList\r\n  },\r\n  data() {\r\n    return {\r\n      banners: [],\r\n      recommends: [],\r\n      goodsList: {\r\n        pop: { page: 1, list: [] },\r\n        new: { page: 1, list: [] },\r\n        sell: { page: 1, list: [] }\r\n      },\r\n      currentType: POP,\r\n      isTabFixed: false,\r\n      tabOffsetTop: 0,\r\n      showBackTop: false\r\n    };\r\n  },\r\n  computed: {\r\n    showGoodsList() {\r\n      return this.goodsList[this.currentType].list;\r\n    }\r\n  },\r\n  created() {\r\n    // console.log('创建Home');\r\n    // 1.请求多个数据\r\n    this.getMultiData();\r\n\r\n    // 2.请求商品数据\r\n    this.getHomeProducts(POP);\r\n    this.getHomeProducts(NEW);\r\n    this.getHomeProducts(SELL);\r\n  },\r\n  activated: function() {\r\n    this.$refs.hSwiper.startTimer();\r\n  },\r\n  deactivated: function() {\r\n    this.$refs.hSwiper.stopTimer();\r\n  },\r\n  updated() {\r\n    // this.tabOffsetTop = this.$refs.tabControl.$el.offsetTop\r\n    // console.log(this.tabOffsetTop);\r\n  },\r\n  methods: {\r\n    tabClick(index) {\r\n      switch (index) {\r\n        case 0:\r\n          this.currentType = POP;\r\n          break;\r\n        case 1:\r\n          this.currentType = NEW;\r\n          break;\r\n        case 2:\r\n          this.currentType = SELL;\r\n          break;\r\n      }\r\n    },\r\n    contentScroll(position) {\r\n      // 1.决定tabFixed是否显示\r\n      this.isTabFixed = -position.y > this.tabOffsetTop;\r\n\r\n      // 2.决定backTop是否显示\r\n      this.showBackTop = -position.y > BACKTOP_DISTANCE;\r\n    },\r\n    loadMore() {\r\n      this.getHomeProducts(this.currentType);\r\n    },\r\n    backTop() {\r\n      this.$refs.scroll.scrollTo(0, 0, 300);\r\n      console.log(\"回到顶部\");\r\n    },\r\n    /**\r\n     * 网络请求相关方法\r\n     */\r\n    getMultiData() {\r\n      getHomeMultidata().then(res => {\r\n        this.banners = res.data[BANNER].list;\r\n        this.recommends = res.data[RECOMMEND].list;\r\n        // 下次更新DOM时,获取新的tabOffsetTop值(不保险,可以在updated钩子中获取)\r\n        this.$nextTick(() => {\r\n          this.tabOffsetTop = this.$refs.tabControl.$el.offsetTop;\r\n        });\r\n      });\r\n    },\r\n    getHomeProducts(type) {\r\n      getHomeData(type, this.goodsList[type].page).then(res => {\r\n        // console.log(res)\r\n        const goodsList = res.data.list;\r\n        this.goodsList[type].list.push(...goodsList);\r\n        this.goodsList[type].page += 1;\r\n\r\n        this.$refs.scroll.finishPullUp();\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#home {\r\n  /*position: relative;*/\r\n  height: 100vh;\r\n}\r\n\r\n.nav-bar {\r\n  position: relative;\r\n  top: 0;\r\n  background-color: var(--color-tint);\r\n  font-weight: 700;\r\n  color: #fff;\r\n}\r\n\r\n.content {\r\n  position: absolute;\r\n  top: 44px;\r\n  bottom: 49px;\r\n  left: 0;\r\n  right: 0;\r\n}\r\n\r\n.fixed {\r\n  position: fixed;\r\n  top: 44px;\r\n  left: 0;\r\n  right: 0;\r\n}\r\n\r\n.back-top {\r\n  position: fixed;\r\n  right: 10px;\r\n  bottom: 60px;\r\n}\r\n</style>\r\n"]}]}